<?phpheader('Content-Type: application/json');include_once("config.php");$mysqli = new mysqli("localhost", $username, $password, $database);/* check connection */if ($mysqli->connect_errno) {    printf("Connect failed: %s\n", $mysqli->connect_error);    exit();}if ( strstr( $_POST["text"], "citat" ) ) {	/* Select queries return a resultset */	if ($result = $mysqli->query("SELECT * FROM kaffecitater")) {		$x = rand(0, $result->num_rows);		$query = "SELECT * FROM kaffecitater WHERE id='$x'";		if ( $citatet = $mysqli->query($query) ) {			$citatet = $citatet->fetch_array();			$udput = array(				'response_type' => 'in_channel',				'text' => sprintf("\"%s\"\n - %s, %s", $citatet["Citat"], $citatet["Hvem"], $citatet["Hvor"])			);						echo json_encode($udput);		}				/* free result set */		$result->close();	}}if ( strstr( $_POST["text"], "terning" ) ) {	$terninger = explode( " ", $_POST["text"] );	$terninger = explode( "d", $terninger[1] );	if ( strstr( $terninger[1], "+" ) ) {		$plus = explode( "+", $terninger[1] );		$terninger[1] = $plus[0];		$plus = $plus[1];	} else {		$plus = FALSE;	}	$antal = $terninger[0];	$sider = $terninger[1];		$url = "https://www.random.org/integers/?num=" . $antal . "&min=1&max=" . $sider . "&col=1&base=10&format=plain&rnd=new";    $options = array(        CURLOPT_RETURNTRANSFER => true,        CURLOPT_HEADER => false,        CURLOPT_FOLLOWLOCATION => true,        CURLOPT_ENCODING => '',        CURLOPT_USERAGENT => 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0',        CURLOPT_AUTOREFERER => true,        CURLOPT_CONNECTTIMEOUT => 120,        CURLOPT_TIMEOUT => 120,        CURLOPT_MAXREDIRS => 10,    );	$ch = curl_init( $url );    curl_setopt_array($ch, $options);    $content = curl_exec($ch);    curl_close($ch);	$resultat = array_slice( explode( "\n", $content ), 0, -1 );		if ( $plus ) {		foreach ( $resultat as &$value ) {			$value += $plus;		}	}	$resultat_tekst = implode( ", ", $resultat ) . " (sum: " . array_sum( $resultat ) . ")";		$udput = array(		'response_type' => 'in_channel',		'text' => sprintf( $resultat_tekst )	);	echo json_encode( $udput );}?>